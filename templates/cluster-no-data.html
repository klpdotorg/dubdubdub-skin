{% extends "layout.html" %}

{% block page_title %}Cluster{% endblock %}
{% block head %}
    {{ parent() }}
	<script src="js/highcharts/highcharts.js"></script>
	<script type="text/javascript" src="js/jquery-ui-1.10.4.custom.min.js"></script>
	<script type="text/javascript" src="js/selectBoxIt.min.js"></script>
{% endblock %}

{% block content %}

	<section class="school-page">
		<div class="page-header">
			<div class="map-canvas"></div>

			<div class="school-info">
				<div class="container">
					<div class="info-wrapper">
						<div class="en-icon big en-school-cluster school-entity-icon">SC</div>
						<h2 class="color-blue">Konanakunte</h2>

						<div class="address-block">
							<div class="info-item">
								<div class="label">District</div>
								<div class="value">Bangalore</div>
							</div>
							<div class="info-item">
								<div class="label">Block</div>
								<div class="value">North-2</div>
							</div>
							<div class="clr"></div>
						</div>
					</div>
					<div class="buttons-wrapper">
						<a class="button dark_grey btn-compare js-trigger-compare" href="">Compare to</a>
					</div>
					<div class="clr"></div>

					<ul class="tabs">
						<li data-tab="info" class="current js-tab-link">Info</li>
						<li data-tab="demographics" class="js-tab-link">Demographics</li>
						<li data-tab="programmes" class="js-tab-link">Programmes</li>
						<li data-tab="library" class="js-tab-link">Library</li>
						<li data-tab="nutrition" class="js-tab-link">Nutrition</li>
						<li data-tab="donate" class="js-tab-link">Donate</li>
						<li data-tab="volunteer" class="js-tab-link">Volunteer</li>
					</ul>
				</div>
			</div>
		</div>

		<div class="school-details js-tabs-wrapper">
			<div class="tab-heading">Info</div>
			<div class="tab-content container current" data-tab="info">
				<div class="fl-desktop">
					<h4>School Information</h4>
					<div  class="detail-item">
						<div class="gender_icons ma">
							<div class="stats_gender_item large fl">
								<div class="en-icon bigger-2 en-school fl mr-10">s</div>
								<div class="label">Schools</div>
								<div class="value color-green">120</div>
								<div class="clr"></div>
							</div>
							<div class="stats_gender_item large fl last">
								<div class="en-icon bigger-2 en-preschool fl mr-10">p</div>
								<div class="label">Preschools</div>
								<div class="value color-purple">130</div>
								<div class="clr"></div>
							</div>
							<div class="clr"></div>
						</div>
					</div>

					<h4 class="mt-20">By Gender</h4>
					<div class="gender_icons">
						<div class="stats_gender_item width-150 boy fl">
							<span class="icon"></span>
							<p class="label">Boys School</p>
							<div class="value">15</div>
							<div class="clr"></div>
						</div>
						<div class="stats_gender_item width-150 girl fl">
							<span class="icon"></span>
							<p class="label">Girls School</p>
							<div class="value">10</div>
							<div class="clr"></div>
						</div>
						<div class="clr"></div>
					</div>

					<h4 class="mt-20">By Typpe</h4>
					<table class="info_data_table">
						<tr>
							<td>Lower Primary</td>
							<td>7</td>
						</tr>
						<tr>
							<td>Higher Primary</td>
							<td>6</td>
						</tr>
						<tr>
							<td>Model School</td>
							<td>10</td>
						</tr>
					</table>
				</div>
				<div class="photos-block fr-desktop">
					<h4>Photos</h4>
					<a href=""><img src="images/map_photo.jpg" alt=""></a>
					<a href=""><img src="images/map_photo.jpg" alt=""></a>
					<a href=""><img src="images/map_photo.jpg" alt=""></a>
					<a href=""><img src="images/map_photo.jpg" alt=""></a>
					<a href=""><img src="images/map_photo.jpg" alt=""></a>
					<a href=""><img src="images/map_photo.jpg" alt=""></a>
					<a href=""><img src="images/map_photo.jpg" alt=""></a>
					<a href=""><img src="images/map_photo.jpg" alt=""></a>
					<div class="clr"></div>
				</div>
				<div class="clr"></div>
			</div>	<!-- Info Tab END -->
			
			<div class="tab-heading">Demographics</div>
			<div class="tab-content container" data-tab="demographics">
				
				<div class="pb-60 mb-60">No data available.</div>

			</div>	<!-- Demographics Tab END -->

			<div class="tab-heading">Programmes</div>
			<div class="tab-content container" data-tab="programmes">
				
				<div class="pb-60 mb-60">No data available.</div>

			</div>	<!-- Programme Tab END -->

			<div class="tab-heading">Library</div>
			<div class="tab-content container" data-tab="library">

				<div class="pb-60 mb-60">No data available.</div>

			</div>	<!-- Library Tab END -->
			
			<div class="tab-heading">Nutrition</div>
			<div class="tab-content container" data-tab="nutrition">
				
				<div class="pb-60 mb-60">No data available.</div>

			</div>	<!-- Nutrition Tab END -->

			<div class="tab-heading">Donate</div>
			<div class="tab-content container" data-tab="donate">
				
				<div class="pb-60 mb-60">No donation requests available.</div>

			</div>	<!-- Donate Tab END -->

			<div class="tab-heading">Volunteer</div>
			<div class="tab-content container" data-tab="volunteer">
				
				<div class="pb-60 mb-60">No volunteering opportunities available.</div>

			</div>	<!-- Volunteer Tab END -->

		</div>

	</section>

	<script type="text/javascript">
		var container_width = 960;

		function init_tabs(){
    		$(document).on("click", ".js-tab-link", function(e){
    			var $wrapper = $(".js-tabs-wrapper");
				var $trigger = $(this).closest(".js-tab-link");
				var tab_id = $trigger.attr('data-tab');

				// Change current tab link
				$trigger.parent().find("li.current").removeClass('current');
				$trigger.addClass("current");

				// Change current tab content
				$wrapper.find(".tab-content.current").removeClass('current');
				$wrapper.find('.tab-content[data-tab="'+ tab_id +'"]').addClass('current');
			});
    	}

    	function init_selects(){
    		
    		$(".apply-selectboxit").selectBoxIt({
				autoWidth: true
			});
    	}

    	function init_library_view_toggle(){
    		var $toggler = $("#library_graph_table_switch");
    		var $graph = $("#graph_library");
    		var $table = $("#table_library");

    		$toggler.on("click", function(e){
    			e.preventDefault();

    			if($graph.is(":visible") ){
    				$graph.hide();
    				$table.show();
    				$toggler.text("Switch to Graph View");
    			} else {
    				$graph.show();
    				$table.hide();
    				$toggler.text("Switch to Table View");
    			}

    		});
    	}

	    function get_relative_height(width, height, min_height){
    		var ht = (height/width)*container_width;
    		ht = parseInt(ht,10);

    		if(ht<min_height){
    			return min_height;
    		}

    		// If number is odd, convert to even
    		if(Math.abs(ht) % 2 == 1){
    			ht++;
    		}
    		return ht;
    	}

    	$(document).ready(function(){
			init_tabs();
			init_selects();
			init_library_view_toggle();

			container_width = $(document).find(".container:first").width();
			container_width = parseInt(container_width,10);

			var chart_gradient_param = [0, 0, 0, 300];

			if(container_width<960){
				chart_gradient_param = [0, 0, 0, 200];
			}
			if(container_width<600){
				chart_gradient_param = [0, 0, 0, 110];
			}

			$('#pie_chart_1').highcharts({
		        chart: {
		            height: 170,
		            width:170,
		            plotBackgroundColor: null,
		            plotBorderWidth: 0,
		            plotShadow: false
		        },
		        title: {
		            text: null
		        },
		        plotOptions: {
		            pie: {
		                dataLabels: {
		                    enabled: false
		                },
		                startAngle: 0,
		                endAngle: 360,
		                center: ['50%', '50%'],
		                colors: ['#609adf', '#f87c84']
		            }
		        },
		        series: [{
		            type: 'pie',
		            name: 'Count',
		            innerSize: '80%',
		            data: [
		                ['Boys', 65.0],
		                ['Girls', 35.0]
		            ]
		        }],
		        credits:{
		        	enabled:false
		        },
		        tooltip:{
		        	enabled:true,
		        	formatter: function() {
		                return '<b>'+ this.y +'%</b>';
		            }
		        },
		        exporting:{
		        	enabled:false
		        }
		    });

			$('#pie_chart_finance').highcharts({
		        chart: {
		        	width: container_width,
		            height: 200,
		            plotBackgroundColor: null,
		            plotBorderWidth: 0,
		            plotShadow: false
		        },
		        title: {
		            text: null
		        },
		        plotOptions: {
		            pie: {
		                dataLabels: {
		                    enabled: true
		                },
		                startAngle: 0,
		                endAngle: 360,
		                center: ['50%', '50%'],
		                colors: ['#329186', '#c8273e', '#f68300']
		            }
		        },
		        series: [{
		            type: 'pie',
		            name: 'Count',
		            innerSize: '60%',
		            data: [
		                ['TLM', 46],
		                ['SMG', 24],
		                ['SG', 30]
		            ]
		        }],
		        credits:{
		        	enabled:false
		        },
		        tooltip:{
		        	enabled:true,
		        	formatter: function() {
		                return '<b>'+ this.y +'%</b>';
		            }
		        },
		        exporting:{
		        	enabled:false
		        }
		    });

			$('#graph_library').highcharts({
	            chart: {
	                type: 'area',
	                width: container_width,
	                height: get_relative_height(960,400, 200)
	            },
	            title: {
	                text: null
	            },
	            xAxis: {
	            },
	            yAxis: {
	                title: {
	                    text: 'Avg. No. of transations per student'
	                },
	                labels: {
	                    formatter: function() {
	                        return this.value;
	                        // return this.value / 1000 +'k';
	                    }
	                }
	            },credits:{
		        	enabled:false
		        },
	            tooltip: {
	                // pointFormat: '{series.name} produced <b>{point.y:,.0f}</b><br/>warheads in {point.x}'
	            },
	            plotOptions: {
	                area: {
	                	fillOpacity:1
	                }
	            },
	            series: [{
	                name: 'Easy',
	                data: [0.2, 0.3, 0.4, 0.5, 0.8, 0.4 , 0.6, 0.4, 0.6, 0.4, 0.2, 0 ],
	                color: '#56af31',
	                fillColor: {
	                    linearGradient: chart_gradient_param,
	                    stops: [
	                        [0, '#e5f3e0'],
	                        [1, 'rgba(255,255,255,0.3)']
	                    ]
	                }
	            }, {
	                name: 'Medium',
	                data: [0, 0.2, 0.4, 0.4, 0.5, 0.8, 0.2 , 0.3, 0.4, 0.3, 0.4, 0.2 ],
	                color: '#3892e3',
	                fillColor: {
	                    linearGradient: chart_gradient_param,
	                    stops: [
	                        [0, '#92c3ef'],
	                        [1, 'rgba(255,255,255,0.3)']
	                    ]
	                }
	            }, {
	                name: 'Hard',
	                data: [0, 0.2, 0.4, 0.2, 0.2, 0.4, 0.3 , 0.2, null, null, null, null ],
	                color: '#cb0012',
	                fillColor: {
	                    linearGradient: chart_gradient_param,
	                    stops: [
	                        [0, '#de69c4'],
	                        [1, 'rgba(255,255,255,0.3)']
	                    ]
	                }
	            }]
	        });

			$('#graph_nutrition').highcharts({
	            chart: {
	                type: 'area',
	                width: container_width,
	                height: get_relative_height(960,400, 230)
	            },
	            title:{
	            	text: null
	            },
	            subtitle: {
	                text: "'Food Indent' vs 'Attendance Tracking'"
	            },
	            xAxis: {
	            	// categories: ['Easy', 'Medium', 'Hard']
	                // allowDecimals: false,
	                // labels: {
	                //     formatter: function() {
	                //         return this.value; // clean, unformatted number for year
	                //     }
	                // }
	            },
	            yAxis: {
	                title: {
	                    text: 'Number of children'
	                },
	                labels: {
	                    formatter: function() {
	                        return this.value;
	                        // return this.value / 1000 +'k';
	                    }
	                }
	            },
	            credits:{
		        	enabled:false
		        },
	            tooltip: {
	                // pointFormat: '{series.name} produced <b>{point.y:,.0f}</b><br/>warheads in {point.x}'
	            },
	            plotOptions: {
	                area: {
	                	fillOpacity:1
	                }
	            },
	            series: [{
	                name: 'Easy',
	                data: [0.2, 0.3, 0.4, 0.5, 0.8, 0.4 , 0.6, 0.4, 0.6, 0.4, 0.2, 0 ],
	                color: '#56af31',
	                fillColor: {
	                    linearGradient: chart_gradient_param,
	                    stops: [
	                        [0, '#e5f3e0'],
	                        [1, 'rgba(255,255,255,0.3)']
	                    ]
	                }
	            }, {
	                name: 'Medium',
	                data: [0, 0.2, 0.4, 0.4, 0.5, 0.8, 0.2 , 0.3, 0.4, 0.3, 0.4, 0.2 ],
	                color: '#3892e3',
	                fillColor: {
	                    linearGradient: chart_gradient_param,
	                    stops: [
	                        [0, '#92c3ef'],
	                        [1, 'rgba(255,255,255,0.3)']
	                    ]
	                }
	            }, {
	                name: 'Hard',
	                data: [0, 0.2, 0.4, 0.2, 0.2, 0.4, 0.3 , 0.2, null, null, null, null ],
	                color: '#cb0012',
	                fillColor: {
	                    linearGradient: chart_gradient_param,
	                    stops: [
	                        [0, '#de69c4'],
	                        [1, 'rgba(255,255,255,0.3)']
	                    ]
	                }
	            }]
	        });
		});

	</script>

{% endblock %}
